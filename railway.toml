[build]
builder = "nixpacks"
buildCommand = "npm install && cd apps/api && npx prisma generate && npm run build"
startCommand = "cd apps/api && npx prisma db push && npm start"

[deploy]
numReplicas = 1
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "api"
internalPort = 3001
